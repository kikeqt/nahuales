__version__ = "$Version: 1.0.0"

from unittest import TestCase

from tools.bytes_2_binary_string import Bytes2BinaryString
from .rotate_on_right_4_bits import RotateOnRight4Bits


class RotateOnRight4BitsTest(TestCase):

    def setUp(self):
        self.test_object = RotateOnRight4Bits()

    def test_rotate_on_right_4_bits(self):
        bytes_2_bin_str = Bytes2BinaryString()
        test_value = b'@ABC'

        test_values = (
            '01000000 01000001 01000010 01000011',
            '10100000 00100000 10100001 00100001',
            '11010000 00010000 01010000 10010000',
            '01101000 00001000 00101000 01001000',
            '00110100 00000100 00010100 00100100',
            '00011010 00000010 00001010 00010010',
            '00001101 00000001 00000101 00001001',
            '10000110 10000000 10000010 10000100',
            '01000011 01000000 01000001 01000010',
            '00100001 10100000 00100000 10100001',
            '10010000 11010000 00010000 01010000',
            '01001000 01101000 00001000 00101000',
            '00100100 00110100 00000100 00010100',
            '00010010 00011010 00000010 00001010',
            '00001001 00001101 00000001 00000101',
            '10000100 10000110 10000000 10000010',
            '01000010 01000011 01000000 01000001',
            '10100001 00100001 10100000 00100000',
            '01010000 10010000 11010000 00010000',
            '00101000 01001000 01101000 00001000',
            '00010100 00100100 00110100 00000100',
            '00001010 00010010 00011010 00000010',
            '00000101 00001001 00001101 00000001',
            '10000010 10000100 10000110 10000000',
            '01000001 01000010 01000011 01000000',
            '00100000 10100001 00100001 10100000',
            '00010000 01010000 10010000 11010000',
            '00001000 00101000 01001000 01101000',
            '00000100 00010100 00100100 00110100',
            '00000010 00001010 00010010 00011010',
            '00000001 00000101 00001001 00001101',
            '10000000 10000010 10000100 10000110',
            '01000000 01000001 01000010 01000011',
            '10100000 00100000 10100001 00100001',
            '11010000 00010000 01010000 10010000',
            '01101000 00001000 00101000 01001000',
            '00110100 00000100 00010100 00100100',
            '00011010 00000010 00001010 00010010',
            '00001101 00000001 00000101 00001001',
            '10000110 10000000 10000010 10000100',
            '01000011 01000000 01000001 01000010',
            '00100001 10100000 00100000 10100001',
            '10010000 11010000 00010000 01010000',
            '01001000 01101000 00001000 00101000',
            '00100100 00110100 00000100 00010100',
            '00010010 00011010 00000010 00001010',
            '00001001 00001101 00000001 00000101',
            '10000100 10000110 10000000 10000010',
            '01000010 01000011 01000000 01000001',
            '10100001 00100001 10100000 00100000',
            '01010000 10010000 11010000 00010000',
            '00101000 01001000 01101000 00001000',
            '00010100 00100100 00110100 00000100',
            '00001010 00010010 00011010 00000010',
            '00000101 00001001 00001101 00000001',
            '10000010 10000100 10000110 10000000',
            '01000001 01000010 01000011 01000000',
            '00100000 10100001 00100001 10100000',
            '00010000 01010000 10010000 11010000',
            '00001000 00101000 01001000 01101000',
            '00000100 00010100 00100100 00110100',
            '00000010 00001010 00010010 00011010',
            '00000001 00000101 00001001 00001101',
            '10000000 10000010 10000100 10000110',
        )

        for item in range(len(test_values)):
            rot_result = self.test_object.rotate_on_right_4_bits(
                test_value, item)

            self.assertEqual(
                test_values[item],
                bytes_2_bin_str.bytes_2_binary_string(rot_result, block_size=8)
            )
